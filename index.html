<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <link href="css/stylesheet.css" rel="stylesheet" type="text/css" media="screen">
        <link href="css/thirdparty/rainbow.github.css" rel="stylesheet" type="text/css" media="screen">
        <!--[if lt IE 9]>
          <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <title>FourScore</title>
        <style>
            #container p.screenshot {
                text-align: center;
            }

            #container img.screenshot {
                max-width: 400px;
                margin-left: auto;
                margin-right: auto;
                margin-top: 16px;
                margin-bottom: 16px;
            }
        </style>
    </head>

    <body>
        <div id="container">

            <header>
                <div class="wrapper">
                    <h1>FourScore</h1>
                    <h2>Let your readers show where their opinion falls on a complicated issue.</h2>

                    <section class="clearfix">
                        <a href="https://github.com/veltman/fourscore" id="view-on-github" class="button"><span>View on GitHub</span></a>
                        <div class="logos">
                            <a href="http://opennews.org" class="org-logo"><img src="img/opennews-logo.png"></a>
                            <p><a href="http://opennews.org/code.html">Released for OpenNews Code Convening, April 2014</a></p>
                        </div>
                    </section>
                </div>
            </header>

            <div class="wrapper">
                <section id="about">
                    <h2>About FourScore</h2>
                    <p>FourScore is a bootstrapper for letting audience members mark their position on a grid, like the <a href="http://nymag.com/arts/all/approvalmatrix/approval-matrix-2013-11-25/">New York magazine approval matrix</a> and the <a href="http://www.wnyc.org/story/297640-government-surveillance-how-worried-are-you/">WNYC Sentiment Tracker</a>.</p>
                    <p>The grid will be color-coded by the number of responses on each square, and you can supply additional form fields so that users can submit things like their name, their age, or a comment along with their position on the grid.</p>
                    <p class="screenshot"><img class="screenshot" src="img/screenshot-1.png"/></p>
                </section>

                <section id="requirements">
                    <h3>Requirements</h3>
                    <ul>
                        <li><a href="http://jquery.com" target="_blank">jQuery</a></li>
                    </ul>
                    <h3>Optional</h3>
	                  </ul>
                        <li><a href="http://underscorejs.org" target="_blank">Underscore</a> or <a href="http://handlebarsjs.com/" target="_blank">Handlebars</a> for templating, if you want to display the results of a custom form.</li>
                        <li><a href="https://github.com/mbostock/d3/blob/master/lib/colorbrewer/colorbrewer.js" target="_blank">ColorBrewer.js</a> if you want to use its built-in color scales.</li>
                        <li><a href="https://github.com/jsoma/tabletop" target="_blank">Tabletop.js</a> if you want existing responses to be loaded from a Google Spreadsheet.</li>
                    </ul>
                </section>

                <section id="browser-support">
                    <h3>Tested with</h3>
                    <ul>
                        <li>Safari</li>
                        <li>Chrome</li>
                        <li>Firefox</li>
                        <li>IE8+</li>
                    </ul>
                </section>

                <section id="quickstart">
                    <p>Most of FourScore should work out of the box.  The only two things you MUST provide are:
                        <ul>
                            <li><strong>A data source</strong>: a URL that contains existing responses.  This will be loaded when the grid is initially drawn in order to color code the squares and display things like comments if you're gathering those.  You can use a Google form for this.</li>
                            <li><strong>A data destination</strong>: a URL to send new form responses to.  This will get a POST with new data if someone clicks on the grid and submits a response.  You can use a Google form for this.</li>
                        </ul>
                    </p>
                </section>

                <section id="quickstart">
                    <h2>Quickstart: use a Google form</h2>
                    <p>To power a FourScore grid with a Google spreadsheet, do the following:
                        <ol>
                            <li>Clone the <a href="https://github.com/veltman/fourscore" target="_blank">FourScore repo</a> to download the files.</li>
                            <li>Create a Google form.  It must have a field called <code>X</code> and a field called <code>Y</code>.  You can add as many other fields as you want, like a field for name and a field for gender.  Any form fields you add besides <code>X</code> and <code>Y</code> will be turned into a form that appears when a user clicks on the grid.  If you make fields required, they will also be required when a user submits the form.</li>
                            <p class="screenshot"><img class="screenshot" src="img/screenshot-2.png"/></p>
                            <li>Turn the information about the Google form into a set of configuration options to put into the <code>config.json</code> file that comes with FourScore.  You can do this automatically if you drag this link to your bookmarks bar:<br><br><a href="javascript:(function(){if(window.jQuery===undefined){var done=false;var script=document.createElement('script');script.src='https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js';script.onload=script.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState=='loaded'||this.readyState=='complete')){done=true;initBookmarklet()}};document.getElementsByTagName('head')[0].appendChild(script)}else{initBookmarklet()}function getInput(el){var item={name:trim($('label .ss-q-title',el).text()),required:!!$('.ss-required-asterisk',el).length},$i=$('input',el),$s=$('select:first',el),$t=$('textarea:first',el);if($i.length&&!$('table',el).length){item.type=$i.first().attr('type');item.field=$i.first().attr('name');if(item.type=='radio'||item.type=='checkbox'){item.choices=$i.map(function(){return $(this).val()}).get()}}else if($s.length){item.type='select';item.field=$s.attr('name');item.choices=$s.find('option').map(function(){return $(this).val()}).get()}else if($t.length){item.type='textarea';item.field=$t.attr('name')}return'type'in item?item:null}function initBookmarklet(){var $div=$('<div></div>'),$pre=$('<pre><code></code></pre>').css('white-space','pre-wrap'),options={options:{dataSource:{url:'SPREADSHEET KEY GOES HERE',type:'google'},gridSize:10,xAxis:['Less X','More X'],yAxis:['More Y','Less Y'],gridTarget:'gridId',commentsTarget:'commentsId',colors:{name:'Reds',number:5}},dataDestination:$('form#ss-form').attr('action'),fields:$('form#ss-form div.ss-form-question div.ss-form-entry').map(function(){return getInput(this)}).get().filter(function(d){return d!==null})};if($.grep(options.fields,function(i){return i.name.toLowerCase()=='x'}).length!=1||$.grep(options.fields,function(i){return i.name.toLowerCase()=='y'}).length!=1){$div.append('<h1>Unable to fetch options. Make sure you have an X and Y field in your form.</h1>')}else{$div.append('<h1>Options for Sentiment Tracker:</h1>');$pre.append(JSON.stringify(options,null,'  '));$div.append($pre)}$div.attr('id','sentiment-tracker').css({'background-color':'white',border:'1px solid black',padding:'10px',margin:'50px 10px'});$('div#sentiment-tracker').remove();$('body').prepend($div)}function trim(s){return(s||'').replace(/^\s+|(\s|[*])+$/g,'')}})();" class="bookmarklet">Google Form to JSON</a><br><br>From the form editor, click 'View Live Form' and then click the bookmarklet.  It will show you the configuration for your FourScore based on the form, which can be copied and pasted into <code>config.json</code>.</li>
                            <p class="screenshot"><img class="screenshot" src="img/screenshot-3.png"/></p>
                            <li>Replace the spreadsheet key (it probably says 'SPREADSHEET KEY GOES HERE') in <code>config.json</code> with the key or the URL of the Google spreadsheet collecting your form responses.  You can get this URL from the form editor by clicking 'View Responses.'</li>
                            <p class="screenshot"><img class="screenshot" src="img/screenshot-4.png"/></p>
                            <li>You should now have a working FourScore grid with basic default settings.  You can customize the style and options to your heart's content (see 'Advanced Configuration').</li>
                        </ol>
                    </p>
                </section>

                <section id="custom-form">
                    <h3>Making your own form</h3>

                    <div class="example-block">
                        <p>If you want to create your own form instead of using a Google form, you will need to manually specify a form endpoint and a list of fields in <code>config.json</code>.</p>
                        <p>The <code>dataDestination</code> option should be set to the URL that will receive POST requests when the user submits the form:</p>
                        <p><pre><code>"dataDestination": "/saveform/"</code></pre></p>
                        <p>The <code>fields</code> option should be a list of form fields with the following properties:</p>
                        <ul>
                            <li><code>name</code> - a human-readable field name, like "Comment"</li>
                            <li><code>required</code> - <code>true</code> or <code>false</code>.</li>
                            <li><code>type</code> - a form element type to use. Can be <code>text</code>, <code>textarea</code>, <code>select</code>, <code>radio</code>, <code>checkbox</code>, <code>number</code>, or <code>date</code>. This will determine what sort of form element is created for the user to fill out.</li>
                            <li><code>choices</code> - If the type is <code>radio</code>, <code>checkbox</code>, or <code>select</code>, you also need to supply a list of choices to populate the form, like: <code>["Apples","Oranges","Bananas"]</code></li>
                        </ul>
                        <p>Your custom list of fields must include a field with the <code>name</code> <code>X</code> and a field with the <code>name</code> <code>Y</code>.  The <code>type</code> property is irrelevant for these two fields.</p>
                    </div>
                </section>

                <section id="configuration">
                    <h3>Additional Configuration</h3>

                    <div class="example-block">
                        <p>
                        	<ul>
                        		<li><code>dataSource.type</code>: Set this to <code>json</code> if you're loading a local JSON file or <code>google</code> if you want to pull existing data straight from a Google Spreadsheet (which is risky, <a href="#the-case-against-google-docs" target="_blank">read more about that</a>).</li>
                        		<li><code>dataSource.url</code>: This is the path to your existing data file relative to <code>main.js</code>, or the key of your Google Spreadsheet e.g. <code>0AV3Xzo4fuxd_mnV0hXZSZJRbTZSOU5JTSJJdk2OUE</code></li>
                        		<li><code>gridSize</code>: The number of cells in your grid. For a 10x10 grid, enter <code>10</code>.</li>
                                <li><code>xAxis</code>: An array of your two x-axis labels, like: <code>["LEFT","RIGHT"]</code></li>
                                <li><code>yAxis</code>: An array of your two y-axis labels, like: <code>["TOP","BOTTOM"]</code></li>
                        		<li><code>gridTarget</code>: The ID or CSS selector of a div to draw your grid in. This must already exist in <code>index.html</code>.</li>
                                <li><code>commentsTarget</code>: The ID or CSS selector of a div to draw reader comments in (see 'Templating reader comments' below). This must already exist in <code>index.html</code>. (optional)</li>
                        		<li><code>colors</code>: An array of colors to use for different numbers of responses per square, like: <code>["red","yellow","blue"]</code> or <code>["#ffffff","#cc0000","#ff0000"]</code>
                        	</ul>
                        </p>

                        <p>
                            Instead of supplying a list of colors, you can use an existing <a href="http://bl.ocks.org/mhkeller/10504471" target="_blank">Color Brewer scale</a> by supplying a scale <code>name</code> and <code>number</code>:

<pre><code>colors: {
    "name": "Reds",
    "number": 5
}</code></pre>
                        </p>
                </section>

                <section id="templating-reader-comments">
                    <h3>Templating reader comments</h3>

                        If your audience is submitting additional information, like comments, along with their grid position, you'll want to define a template for how to display those fields in the list.

                        <p>The included <code>index.html</code> has a basic Underscore template at the bottom.  Change the contents of this template to display the fields you want.  If you prefer to use Handlebars for your template, change <code>data-template-type</code> to <code>handlebars</code> and modify the contents.  If you want an automatic minimap displayed next to each comment, make sure to include a div with the class <code>st-mini-map</code>.</p>

<pre><code>&lt;script type="text/template" id="st-comment-template" data-template-type="underscore"&gt;
    &lt;div class="st-comment-container"&gt;
        &lt;div class="st-mini-map"&gt;&lt;/div&gt;
        &lt;div class="st-name"&gt;&lt;%= name %&gt;&lt;/div&gt;
        &lt;div class="st-comment"&gt;&lt;%= comment %&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/script&gt;</code></pre>

<pre><code>&lt;script type="text/template" id="st-comment-template" data-template-type="handlebars"&gt;
    &lt;div class="st-comment-container"&gt;
        &lt;div class="st-mini-map"&gt;&lt;/div&gt;
        &lt;div class="st-name"&gt;{{name}}&lt;/div&gt;
        &lt;div class="st-comment"&gt;{{comment}}&lt;/div&gt;
    &lt;/div&gt;
&lt;/script&gt;</code></pre>

                </section>

                <section id="styling">
                    <h3>Styling</h3>
                    <p>Much of the way FourScore looks can be customized by editing the enclosed stylesheets:
                        <ul>
                            <li><code>st-base.css</code> - this contains core styles for drawing the grid and displaying comments along with it. Edit at your own risk.</li>
                            <li><code>st-theme.css</code> - this contains styles for the size of the grid, fonts, the breakpoints for smaller screens, and that sort of thing.  You should feel free to edit this or add to it to customize the look and feel of your FourScore grid.</li>
                        </ul>
                    </p>
                </section>

                <section id="license">
                    <h3>License</h3>
                    <p>MIT.</p>
                </section>

                <footer>
                    <p>fourscore is maintained by <a href="https://github.com/veltman">Noah Veltman</a> &amp; <a href="https://github.com/mhkeller">Michael Keller</a></p>
                </footer>
            </div>
        </div>
        <script src="js/thirdparty/jquery-2.1.0.min.js"></script>
        <script src="js/thirdparty/rainbow-custom.min.js"></script>
    </body>
</html>
